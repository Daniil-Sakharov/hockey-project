# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## üéØ –û–±–∑–æ—Ä

–ü–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –î–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏.

---

## üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. `verify_player_stats.go` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –∏–≥—Ä–æ–∫–æ–≤

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ –∏–≥—Ä–æ–∫–æ–≤ –∏–º–µ—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ —É –∫–æ–≥–æ –µ—ë –Ω–µ—Ç.

**–ó–∞–ø—É—Å–∫:**
```bash
task db:verify-stats
# –∏–ª–∏
go run scripts/verify_player_stats.go
```

**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- ‚úÖ –û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (% –∏–≥—Ä–æ–∫–æ–≤ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π)
- üìÖ –†–∞–∑–±–∏–≤–∫–∞ –ø–æ –≥–æ–¥–∞–º —Ä–æ–∂–¥–µ–Ω–∏—è
- üë§ –ü—Ä–∏–º–µ—Ä—ã –∏–≥—Ä–æ–∫–æ–≤ –±–µ–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- üèÜ –¢—É—Ä–Ω–∏—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
üìä –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
  –í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤:           14,547
  –°–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π:          7,246 (49.81%)
  –ë–ï–ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:          7,301 (50.19%)

üìÖ –ò–ì–†–û–ö–ò –ë–ï–ó –°–¢–ê–¢–ò–°–¢–ò–ö–ò –ü–û –ì–û–î–ê–ú –†–û–ñ–î–ï–ù–ò–Ø:

üî¥ –ì–û–î –†–û–ñ–î–ï–ù–ò–Ø: 2014
  –í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤:    1131
  –°–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π:   79 (6.98%)
  –ë–ï–ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:   1052 (93.02%)

  üìã –ü—Ä–∏–º–µ—Ä—ã –∏–≥—Ä–æ–∫–æ–≤ –ë–ï–ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
  [1] –ê–±–∞–∫—É–º–æ–≤ –ú–∞–∫–∞—Ä –ê–ª–µ–∫—Å–µ–µ–≤–∏—á (ID: 14157437)
      –¢—É—Ä–Ω–∏—Ä—ã: 2
        - –ö—É–±–æ–∫ –§–µ–¥–µ—Ä–∞—Ü–∏–∏ 11/10/9/8 –ª–µ—Ç
          https://komi.fhr.ru/tournaments/...
```

---

### 2. `verify_tournament_stats.go` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è —Ç—É—Ä–Ω–∏—Ä–æ–≤

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–∫—Ä—ã—Ç–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Ç—É—Ä–Ω–∏—Ä—É.

**–ó–∞–ø—É—Å–∫:**
```bash
task db:verify-tournaments
# –∏–ª–∏
go run scripts/verify_tournament_stats.go
```

**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- ‚úÖ –¢—É—Ä–Ω–∏—Ä—ã —Å –æ—Ç–ª–∏—á–Ω—ã–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º (100%)
- ‚ö†Ô∏è –¢—É—Ä–Ω–∏—Ä—ã —Å–æ —Å—Ä–µ–¥–Ω–∏–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º (50-79%)
- üî¥ –¢—É—Ä–Ω–∏—Ä—ã —Å –Ω–∏–∑–∫–∏–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º (1-49%)
- ‚ùå –¢—É—Ä–Ω–∏—Ä—ã –±–µ–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (0%)

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
üìä –í—Å–µ–≥–æ —Ç—É—Ä–Ω–∏—Ä–æ–≤: 36

‚úÖ –û–¢–õ–ò–ß–ù–û–ï –ü–û–ö–†–´–¢–ò–ï (100%): 15 —Ç—É—Ä–Ω–∏—Ä–æ–≤
[1] –ü–µ—Ä–≤–µ–Ω—Å—Ç–≤–æ –£–§–û 14/13/12 –ª–µ—Ç
    –ò–≥—Ä–æ–∫–æ–≤: 450 | –ó–∞–ø–∏—Å–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: 3018
    URL: https://ufo.fhr.ru/tournaments/...

‚ùå –ë–ï–ó –°–¢–ê–¢–ò–°–¢–ò–ö–ò (0%): 7 —Ç—É—Ä–Ω–∏—Ä–æ–≤
[1] –ö—É–±–æ–∫ –§–µ–¥–µ—Ä–∞—Ü–∏–∏ –£–§–û –¥–æ 11 –ª–µ—Ç
    –ò–≥—Ä–æ–∫–æ–≤: 120 | –ó–∞–ø–∏—Å–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: 0
    URL: https://ufo.fhr.ru/tournaments/...

üìà –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
  ‚úÖ –û—Ç–ª–∏—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (100%):    15 —Ç—É—Ä–Ω–∏—Ä–æ–≤
  ‚úÖ –•–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (80-99%):   8 —Ç—É—Ä–Ω–∏—Ä–æ–≤
  ‚ö†Ô∏è  –°—Ä–µ–¥–Ω–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (50-79%):  3 —Ç—É—Ä–Ω–∏—Ä–∞
  üî¥ –ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (1-49%):     3 —Ç—É—Ä–Ω–∏—Ä–∞
  ‚ùå –ë–µ–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (0%):         7 —Ç—É—Ä–Ω–∏—Ä–æ–≤
```

---

## üöÄ –¢–∏–ø–∏—á–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

### –ü–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–µ—Ä
task stats:parse

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
task db:stats

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ –∏–≥—Ä–æ–∫–æ–≤
task db:verify-stats

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤
task db:verify-tournaments
```

### –ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (<50%):**
   ```bash
   # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–µ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   task stats:parse
   ```

2. **–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä –±–µ–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL —Ç—É—Ä–Ω–∏—Ä–∞ –∏–∑ –≤—ã–≤–æ–¥–∞ —Å–∫—Ä–∏–ø—Ç–∞
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–∞ —Å–∞–π—Ç–µ –µ—Å—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø–∞—Ä—Å–µ—Ä–∞

3. **–ò–≥—Ä–æ–∫–∏ –±–µ–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
   - –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –ù–µ –≤—Å–µ –∏–≥—Ä–æ–∫–∏ —É—á–∞—Å—Ç–≤—É—é—Ç –≤–æ –≤—Å–µ—Ö —Ç—É—Ä–Ω–∏—Ä–∞—Ö
   - –°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç—É—Ä–Ω–∏—Ä—ã –≥–¥–µ –∏–≥—Ä–æ–∫ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª
   - –ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä—É—á–Ω—É—é –ø–æ —Å—Å—ã–ª–∫–∞–º

---

## üìù –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∏–≥—Ä–æ–∫–æ–≤:

- **>80%** - üéâ –û—Ç–ª–∏—á–Ω–æ! –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤ –∏–º–µ—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
- **50-80%** - ‚úÖ –•–æ—Ä–æ—à–æ, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å
- **<50%** - ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–µ—Ä

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤:

- **100%** - ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ! –í—Å–µ –∏–≥—Ä–æ–∫–∏ —Ç—É—Ä–Ω–∏—Ä–∞ –∏–º–µ—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
- **80-99%** - ‚úÖ –•–æ—Ä–æ—à–æ, –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–≥—Ä–æ–∫–æ–≤ –±–µ–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- **50-79%** - ‚ö†Ô∏è –°—Ä–µ–¥–Ω–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ, –≤–æ–∑–º–æ–∂–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞
- **1-49%** - üî¥ –ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ, –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞
- **0%** - ‚ùå –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ —Å–æ–±—Ä–∞–Ω–∞, –≤–æ–∑–º–æ–∂–Ω–æ –µ—ë –Ω–µ—Ç –Ω–∞ —Å–∞–π—Ç–µ

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ü–æ—á–µ–º—É –ø–æ–∫—Ä—ã—Ç–∏–µ –∏–≥—Ä–æ–∫–æ–≤ ~50%?**  
A: –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –í –ë–î –µ—Å—Ç—å –∏–≥—Ä–æ–∫–∏ –∏–∑ –í–°–ï–• —Ç—É—Ä–Ω–∏—Ä–æ–≤, –Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∞—Ä—Å–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑ 36 —Ç—É—Ä–Ω–∏—Ä–æ–≤. –ò–≥—Ä–æ–∫–∏ –∏–∑ –¥—Ä—É–≥–∏—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤ –Ω–µ –±—É–¥—É—Ç –∏–º–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

**Q: –ü–æ—á–µ–º—É —É —Ç—É—Ä–Ω–∏—Ä–∞ 0% –ø–æ–∫—Ä—ã—Ç–∏–µ?**  
A: –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
- –ù–∞ —Å–∞–π—Ç–µ —Ç—É—Ä–Ω–∏—Ä–∞ –Ω–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –¥—Ä—É–≥–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- –ü—Ä–æ–±–ª–µ–º–∞ –ø–∞—Ä—Å–µ—Ä–∞ (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏)

**Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –µ—Å—Ç—å –Ω–∞ —Å–∞–π—Ç–µ, –Ω–æ –Ω–µ –ø–∞—Ä—Å–∏—Ç—Å—è?**  
A: 
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø–∞—Ä—Å–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π
3. –í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–∞ –¥–ª—è —ç—Ç–æ–≥–æ —Ç—É—Ä–Ω–∏—Ä–∞

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Å–∫—Ä–∏–ø—Ç—ã:

1. **verify_player_stats.go:**
   ```sql
   -- –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
   SELECT id, name, birth_year FROM players
   
   -- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   SELECT DISTINCT player_id FROM player_statistics
   
   -- –î–ª—è –∏–≥—Ä–æ–∫–æ–≤ –±–µ–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –∏—Ö —Ç—É—Ä–Ω–∏—Ä—ã
   SELECT t.* FROM tournaments t
   JOIN player_teams pt ON t.id = pt.tournament_id
   WHERE pt.player_id = ?
   ```

2. **verify_tournament_stats.go:**
   ```sql
   -- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–∫—Ä—ã—Ç–∏–µ –ø–æ —Ç—É—Ä–Ω–∏—Ä–∞–º
   SELECT 
     t.id,
     COUNT(DISTINCT pt.player_id) as total_players,
     COUNT(DISTINCT ps.player_id) as players_with_stats
   FROM tournaments t
   LEFT JOIN player_teams pt ON t.id = pt.tournament_id
   LEFT JOIN player_statistics ps ON t.id = ps.tournament_id
   GROUP BY t.id
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- Go 1.24+
- PostgreSQL
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `DATABASE_URL`

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
task db:stats

# –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
task db:report

# –û—á–∏—Å—Ç–∫–∞ –ë–î
task db:clear

# –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
task stats:parse
```
